import React, { useState } from "react";
import {
  View,
  Text,
  TouchableOpacity,
  Image,
  ScrollView,
  Switch,
  Linking,
} from "react-native";
import { HelloWave } from "@/components/HelloWave";
import ParallaxScrollView from "@/components/ParallaxScrollView";
import { ThemedText } from "@/components/ThemedText";
import { ThemedView } from "@/components/ThemedView";
import { WebView } from "react-native-webview"; // Import WebView

import Projects from '@/components/Projects';

const App = () => {
  const [isEnabled, setIsEnabled] = useState(true);
  const toggleSwitch = () => setIsEnabled((previousState) => !previousState);
  const [isExpanded, setIsExpanded] = useState(false); // State to toggle description

  // Dynamically style the container based on theme state
  const containerStyle = isEnabled
    ? { flex: 1, backgroundColor: "black" }
    : { flex: 1, backgroundColor: "white" };
  const textStyle = isEnabled ? { color: "white" } : { color: "black" };

  const handleUrlRedirect = (url: string) => {
    Linking.openURL(url).catch((err) =>
      console.error("Failed to open URL", err)
    );
  };

  const renderDescription = (description: String) => {
    if (isExpanded) {
      return (
        <Text style={{ color: "gray", fontSize: 14, marginBottom: 5 }}>
          {description}
        </Text>
      );
    }

    // Truncate the description if it's too long
    const truncatedDescription =
      description.length > 50 ? description.slice(0, 50) + "..." : description;
    return (
      <>
        <Text style={{ color: "gray", fontSize: 14, marginBottom: 5 }}>
          {truncatedDescription}
        </Text>
        <TouchableOpacity onPress={() => setIsExpanded(true)}>
          <Text style={{ color: "blue", fontSize: 14 }}>See more</Text>
        </TouchableOpacity>
      </>
    );
  };
  const handleLinkPress = (url: string): void => {
    Linking.openURL(url).catch((err) =>
      console.error("Failed to open URL", err)
    );
  };

  return (
    <View style={containerStyle}>
      <ParallaxScrollView
        headerBackgroundColor={{
          light: isEnabled ? "Black" : "White",
          dark: isEnabled ? "Black" : "White",
        }}
        headerImage={
          <Image
            source={require("@/assets/images/bg.png")}
            style={{ width: "100%", height: 200, borderRadius: 10 }}
          />
        }
      >
       

        <ThemedView
          style={{
            alignItems: "center",
            padding: 20,
            backgroundColor: isEnabled ? "black" : "white",
            
          }}
        >
           <TouchableOpacity
          onPress={toggleSwitch}
          style={{
            flexDirection: "row",
            justifyContent: "flex-end",
            padding: 0,
          }}
        >
          <Switch
            trackColor={{ false: "#767577", true: "#81b0ff" }}
            thumbColor={isEnabled ? "#f5dd4b" : "#f4f3f4"}
            ios_backgroundColor="#3e3e3e"
            value={isEnabled}
            onValueChange={toggleSwitch}
          />
          <Text style={[textStyle, { paddingLeft: 10, fontSize: 16 }]}>
            {isEnabled ? "üåô DARK" : "üí° LIGHT"}
          </Text>
        </TouchableOpacity>
          <Image
            source={require("@/assets/images/profile.png")}
            style={{ width: 120, height: 120, borderRadius: 60 }}
          />
          <ThemedText style={textStyle} type="title">
            Sneh Jaiswal
          </ThemedText>
          <ThemedText style={textStyle} type="subtitle">
            Full Stack Developer
          </ThemedText>
          <ThemedText style={textStyle}> <Text>üìû +91 7049510697 | üìß snehjaiswal20@gmail.com</Text></ThemedText>
          <Text style={{ fontSize: 16, color: "#000" }}>
            <TouchableOpacity
              onPress={() => handleLinkPress("https://github.com/snehpnp")}
            >
              <Text
                style={{ color: "#007BFF", textDecorationLine: "underline" }}
              >
                üåê GitHub
              </Text>
            </TouchableOpacity>
            {" | "}
            <TouchableOpacity
              onPress={() => handleLinkPress("https://www.linkedin.com/in/sneh-jaiswal-431165229/")}
            >
              <Text
                style={{ color: "#007BFF", textDecorationLine: "underline" }}
              >
                üîó LinkedIn
              </Text>
            </TouchableOpacity>
          </Text>
          {/* <HelloWave /> */}
        </ThemedView>


        {/* About Me Section */}
        <ThemedView
          style={{
            padding: 20,
            backgroundColor: isEnabled ? "black" : "white",
          }}
        >
          <ThemedText style={textStyle} type="subtitle">
            üìñ About Me
          </ThemedText>
          <ThemedText style={textStyle}>
            Passionate developer with expertise in React, React Native, Node.js,
            and MongoDB. Experienced in building scalable web and mobile
            applications.
          </ThemedText>
        </ThemedView>

        {/* Experience Section */}
        <ThemedView
          style={{
            padding: 20,
            backgroundColor: isEnabled ? "black" : "white",
          }}
        >
          <ThemedText style={textStyle} type="subtitle">
            üíº Experience
          </ThemedText>
          <ThemedText style={textStyle} type="defaultSemiBold">
            Full Stack Developer
          </ThemedText>
          <ThemedText style={textStyle}>
            PNP Infotech, Indore | September 2022 - Present
          </ThemedText>
          <ThemedText style={textStyle}>
            - Executed the rollout of over eight major projects with a strong
            focus on building scalable enterprise solutions. - Collaborated with
            cross-functional teams to design and implement real-time systems. -
            Integrated advanced features like dynamic pricing tools, real-time
            notifications, and automated reminders. - Led the development of key
            projects like Stock Box, Outbook, and Smart Algo. - Ensured seamless
            integration of 30+ brokers for trading platforms. - Optimized
            Back-End systems to handle high-volume data processing with zero
            downtime.
          </ThemedText>
        </ThemedView>

        {/* Featured Projects Section */}
        <ThemedView
          style={{
            marginVertical: 20,
            backgroundColor: isEnabled ? "black" : "white",
          }}
        >
          <ThemedText style={textStyle} type="subtitle">
            üìÇ Featured Projects
          </ThemedText>
          <ScrollView horizontal showsHorizontalScrollIndicator={false}>
            <View
              style={{
                borderRadius: 8,
                marginRight: 10,
                padding: 15,
                minWidth: 250,
              }}
            >
              <WebView
                source={{ uri: "https://newpenal.pandpinfotech.com/#/login" }}
                style={{ width: 200, height: 200, marginBottom: 10 }}
              />
              <Text style={{ fontWeight: "bold" }}>Project 1</Text>
              {renderDescription(
                "Short description about Project 1. This can be a longer description that will be truncated if necessary."
              )}
              <TouchableOpacity
                onPress={() =>
                  handleUrlRedirect(
                    "https://newpenal.pandpinfotech.com/#/login"
                  )
                }
              >
                <Text
                  style={{
                    color: "blue",
                    fontSize: 14,
                    textDecorationLine: "underline",
                  }}
                >
                  Go to Project 1
                </Text>
              </TouchableOpacity>
            </View>

            <View
              style={{
                borderRadius: 8,
                marginRight: 10,
                padding: 15,
                minWidth: 250,
              }}
            >
              <WebView
                source={{ uri: "https://newpenal.pandpinfotech.com/#/login" }}
                style={{ width: 200, height: 200, marginBottom: 10 }}
              />
              <Text style={{ fontWeight: "bold" }}>Project 2</Text>
              {renderDescription(
                "Short description about Project 2. Here is some additional text to make this description longer and test the truncation feature."
              )}
              <TouchableOpacity
                onPress={() =>
                  handleUrlRedirect(
                    "https://newpenal.pandpinfotech.com/#/login"
                  )
                }
              >
                <Text
                  style={{
                    color: "blue",
                    fontSize: 14,
                    textDecorationLine: "underline",
                  }}
                >
                  Go to Project 2
                </Text>
              </TouchableOpacity>
            </View>

            <View
              style={{
                borderRadius: 8,
                marginRight: 10,
                padding: 15,
                minWidth: 250,
              }}
            >
              <WebView
                source={{ uri: "https://newpenal.pandpinfotech.com/#/login" }}
                style={{ width: 200, height: 200, marginBottom: 10 }}
              />
              <Text style={{ fontWeight: "bold" }}>Project 3</Text>
              {renderDescription("Short description about Project 3")}
              <TouchableOpacity
                onPress={() =>
                  handleUrlRedirect(
                    "https://newpenal.pandpinfotech.com/#/login"
                  )
                }
              >
                <Text
                  style={{
                    color: "blue",
                    fontSize: 14,
                    textDecorationLine: "underline",
                  }}
                >
                  Go to Project 3
                </Text>
              </TouchableOpacity>
            </View>
          </ScrollView>
        </ThemedView>

        {/* Education Section */}
        <ThemedView
          style={{
            padding: 20,
            backgroundColor: isEnabled ? "black" : "white",
          }}
        >
          <ThemedText style={textStyle} type="subtitle">
            üéì Education
          </ThemedText>
          <ThemedText style={textStyle} type="defaultSemiBold">
            Bachelor of Computer Applications (BCA)
          </ThemedText>
          <ThemedText style={textStyle}>
            Vikram University, Ujjain | 2020 ‚Äì 2023
          </ThemedText>
          <ThemedText style={textStyle}>
            - Specialized in Information Technology alongside the core BCA
            curriculum. - Focused on software development, database management,
            and algorithmic problem-solving.
          </ThemedText>

          <ThemedText style={textStyle} type="defaultSemiBold">
            Higher Secondary Certificate (12th Grade)
          </ThemedText>
          <ThemedText style={textStyle}>
            Government High Secondary School, Nasrullaganj | 2018 ‚Äì 2019
          </ThemedText>

          <ThemedText style={textStyle} type="defaultSemiBold">
            Secondary School Certificate (10th Grade)
          </ThemedText>
          <ThemedText style={textStyle}>
            Government High School, Chitgaon Mouji | 2016 ‚Äì 2017
          </ThemedText>
        </ThemedView>

        {/* Skills Section */}
        <ThemedView
          style={{
            padding: 20,
            backgroundColor: isEnabled ? "black" : "white",
          }}
        >
          <ThemedText style={textStyle} type="subtitle">
            üõ† Skills
          </ThemedText>
          <ThemedText style={textStyle}>
            - Programming Languages: JavaScript - Frontend: React.js, Redux,
            Next.js, React Native - Backend: Node.js, Express.js, MongoDB,
            Firebase - APIs: RESTful APIs, GraphQL - Tools: Git, Docker, Postman
            - Other: Agile/Scrum, CI/CD, Jira
          </ThemedText>
        </ThemedView>

        {/* Footer Section */}
        <ThemedView style={{ backgroundColor: isEnabled ? "black" : "white" }}>
          <Text style={[textStyle, { textAlign: "center", margin: 20 }]}>
            ¬© 2025 Sneh Jaiswal. All Rights Reserved.
          </Text>
        </ThemedView>
      </ParallaxScrollView>
    </View>
  );
};

export default App;
